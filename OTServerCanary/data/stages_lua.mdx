---
title: "stages.lua"
description: "Documenta√ß√£o t√©cnica de stages.lua"
icon: "file-code"
---

<img
  style={{ borderRadius:"0.5rem" }}
  src="/images/Capturadetela2026-02-18162032.png"
  className="hidden dark:block hidden dark:block"
/>
<img
  style={{ borderRadius:"0.5rem" }}
  src="/images/hero-dark.png"
  className="hidden dark:block dark:hidden"
/>

<img
  style={{ borderRadius:"0.5rem" }}
  src="/images/Capturadetela2026-02-18162032.png"
  className="dark:hidden"
/>

## üõ†Ô∏è Informa√ß√µes do Arquivo

Este arquivo define tabelas de configura√ß√£o de "stages" (faixas de n√≠vel) usadas para determinar multiplicadores de experi√™ncia, habilidades e magic level no servidor. √â um componente de configura√ß√£o cr√≠tico que influencia diretamente a progress√£o e o balanceamento dos personagens.

<ResponseField name="Caminho Original" type="path">
  `server/data/stages.lua`
</ResponseField>

<Tip>
  Este arquivo foi mapeado automaticamente pelo **Mintlify Architect**. Certifique-se de validar as depend√™ncias de sistema antes de editar este script.
</Tip>

## üìÑ Vis√£o Geral do C√≥digo

### Resumo Executivo
O `stages.lua` atua como o controlador central da curva de aprendizado do jogo, definindo multiplicadores din√¢micos baseados no n√≠vel do personagem. Sua import√¢ncia reside no balanceamento da economia de tempo do jogador, permitindo uma progress√£o r√°pida no in√≠cio (early game) e mais lenta/estrat√©gica no final (end game).

### An√°lise de Estruturas de Dados

Como este arquivo √© puramente configuracional e n√£o cont√©m fun√ß√µes execut√°veis, a an√°lise foca nas tr√™s tabelas principais que o motor do jogo consome.

#### 1. `experienceStages`
Define a taxa de ganho de experi√™ncia (XP) ao matar monstros.

*   **Estrutura:** Lista de tabelas contendo `{ minlevel, maxlevel, multiplier }`.
*   **Par√¢metros:**
    *   `minlevel` (Number): O n√≠vel inicial para ativar este est√°gio.
    *   `maxlevel` (Number | Opcional): O n√≠vel final deste est√°gio. Se omitido, considera-se infinito.
    *   `multiplier` (Number): O fator pelo qual a experi√™ncia base do monstro √© multiplicada (ex: 20x).
*   **L√≥gica Interna:** O servidor verifica o n√≠vel atual do jogador. Se estiver dentro de um intervalo `minlevel` e `maxlevel`, aplica o `multiplier`.

#### 2. `skillsStages`
Define a taxa de avan√ßo de habilidades f√≠sicas (Fist, Club, Sword, Axe, Distance, Shielding).

*   **Estrutura:** Id√™ntica a `experienceStages`.
*   **Prop√≥sito:** Evitar que jogadores de n√≠vel alto tenham skills desproporcionais, ou permitir que "catch-up" (recupera√ß√£o) seja r√°pido em n√≠veis baixos.
*   **L√≥gica Interna:** Multiplica os "ticks" de treino ou hits necess√°rios para avan√ßar a skill.

#### 3. `magicLevelStages`
Define a taxa de avan√ßo do Magic Level (ML).

*   **Estrutura:** Id√™ntica a `experienceStages`.
*   **Prop√≥sito:** Controlar o poder m√°gico, que escala drasticamente o dano de runas e magias.
*   **L√≥gica Interna:** Multiplica a mana gasta para calcular o avan√ßo do ML.

### Exemplo de Uso

Para adicionar uma nova etapa onde jogadores acima do n√≠vel 3000 ganham apenas 1x de experi√™ncia (Hardcore), voc√™ modificaria a tabela `experienceStages`:

```lua
experienceStages = {
    -- ... est√°gios anteriores ...
    { minlevel = 2001, maxlevel = 2999, multiplier = 10 }, -- Est√°gio anterior fechado
    { minlevel = 3000, multiplier = 1 }                    -- Novo est√°gio final (sem maxlevel)
}
```

### Observa√ß√µes T√©cnicas

*   **Carregamento:** Este arquivo √© carregado via `dofile` no `server/data/core.lua`.
*   **Depend√™ncia do Core:** As vari√°veis globais (`experienceStages`, etc.) s√£o lidas diretamente pelo c√≥digo fonte em C++ (Canary) durante a inicializa√ß√£o ou recarregamento dos scripts.
*   **Performance:** A leitura √© feita em tempo de execu√ß√£o (runtime) ou cacheada pelo C++, dependendo da implementa√ß√£o do motor, mas geralmente tem impacto irrelevante na performance, servindo apenas como tabela de consulta (lookup table).

### Alertas

<Warning>
**Sobreposi√ß√£o de N√≠veis:** Certifique-se de que n√£o haja lacunas ("gaps") ou sobreposi√ß√µes entre o `maxlevel` de um est√°gio e o `minlevel` do pr√≥ximo.
Exemplo Errado:
Est√°gio A: 1-100
Est√°gio B: 102-200
(O n√≠vel 101 ficaria sem multiplicador definido, podendo causar bugs ou cair para 1x).
</Warning>

<Warning>
**Est√°gio Infinito:** O √∫ltimo est√°gio da tabela **n√£o deve** ter um `maxlevel` definido. Isso garante que jogadores que ultrapassem o n√≠vel previsto continuem tendo um multiplicador atribu√≠do.
</Warning>

```lua stages.lua
-- Exemplo visual do arquivo analisado
experienceStages = {
    { minlevel = 1, maxlevel = 100, multiplier = 20 },
    { minlevel = 101, maxlevel = 200, multiplier = 18 },
    -- ...
}
```